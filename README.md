# Информационный поиск с применением глубокого обучения

- spladev2/v1:

  - Бенчмарк splade-cocondenser-ensembledistil на MS MARCO

    - MRR@10 на 3k запросах 39.2, в оригинальной статье 38.0
    - 6 часов на A100 на индексацию
    - ~1 секунда на инференс одного запроса

  - Обучение splade на MS MARCO

    - 120/60 часов обучения на A100 на 40M триплетов (query, positive, negative) из MS MARCO без заморозки BERT encoder / с заморозкой
    - в ответе появляется пунктуация, пока что неочевидно, как с этим бороться
    - в некоторых запросах очень малый набор дополнительных токенов (пример ниже), возможно проблемы с регуляризацией / необходимость тасовать датасет
    - пока что не считались метрики качества полученных токенов

    ```text
      Epoch 1:   0%|          | 1000/1243151 [06:06<564:04:13,  1.63s/it]
      Step 1000: avg loss = 36.2805
      Epoch 1:   0%|          | 2000/1243151 [12:10<572:23:30,  1.66s/it]
      Step 2000: avg loss = 1.9583
      Epoch 1:   0%|          | 3000/1243151 [18:14<560:55:14,  1.63s/it]
      Step 3000: avg loss = 1.2410
      Epoch 1:   0%|          | 4000/1243151 [24:18<564:20:55,  1.64s/it]
      Step 4000: avg loss = 0.8858
      Epoch 1:   0%|          | 5000/1243151 [30:23<576:30:30,  1.68s/it]
      Step 5000: avg loss = 0.7511
      Epoch 1:   0%|          | 5010/1243151 [30:27<125:27:47,  2.74it/s]
    ```

    - плохой тестовый пример:
      ```text
        Query: what is python programming
        Top tokens: [('.', '2.81'), (',', '2.73'), ('!', '2.55'), ('?', '2.43'), (';', '2.42'), ('-', '2.37'), ("'", '2.30'), (':', '2.26'), ('...', '2.23'), (')', '2.22'), ('"', '1.86'), ('python', '1.53'), ('}', '0.68'), ('programming', '0.57'), ('program', '0.46'), ('the', '0.30'), ('bob', '0.10'), ('[PAD]', '0.00'), ('[unused0]', '0.00'), ('[unused1]', '0.00')]
      ```
    - более менее хороший тестовый пример:
      ```text
        Query: best restaurants in paris
        Top tokens: [('.', '2.85'), (',', '2.78'), ('!', '2.56'), (';', '2.43'), ('?', '2.42'), ('-', '2.40'), ("'", '2.32'), (':', '2.30'), ('...', '2.26'), (')', '2.20'), ('"', '1.78'), ('restaurant', '1.64'), ('paris', '1.57'), ('best', '1.31'), ('restaurants', '1.18'), ('hotel', '0.95'), ('france', '0.62'), ('chef', '0.61'), ('food', '0.50'), ('french', '0.41')]
      ```
